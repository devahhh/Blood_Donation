{% extends 'base.html' %}
{% load static %}
{% block content %}

<!-- Sign Up Start -->
<section id="sign-up">
  <div class="container-fluid my-3">
    <img src="{% static 'imgs/logo.png' %}" alt="">

    <form method="post">
      {% csrf_token %}
      <div class="form-group row my-3">
        <label for="inputEmail3" class="col-sm-2 col-form-label">Email</label>
        <div class="col-sm-10">
          <input type="email" class="form-control" id="inputEmail3" name="email" 
                 placeholder="Email" required>
        </div>
      </div>

      <div class="form-group row mb-3">
        <label for="inputPassword3" class="col-sm-2 col-form-label">Password</label>
        <div class="col-sm-10">
          <input type="password" class="form-control" id="inputPassword3" name="password" 
                 placeholder="Password" required>
        </div>
      </div>

      <div class="form-group row mb-3">
        <label for="inputDate" class="col-sm-2 col-form-label">Date of Birth</label>
        <div class="col-sm-10">
          <input type="date" class="form-control" id="inputDate" name="dob" required>
        </div>
      </div>

      <div class="form-group row mb-3">
        <label for="type" class="col-sm-2 col-form-label">Blood Type</label>
        <div class="col-sm-10">
          <select name="type" id="type" class="form-control" required>
            <option value="">Select Blood Type</option>
            <option value="A+">A+</option>
            <option value="A-">A-</option>
            <option value="B+">B+</option>
            <option value="B-">B-</option>
            <option value="O+">O+</option>
            <option value="O-">O-</option>
            <option value="AB+">AB+</option>
            <option value="AB-">AB-</option>
          </select>
        </div>
      </div>

      <div class="form-group row mb-3">
        <label for="phone" class="col-sm-2 col-form-label">Phone Number</label>
        <div class="col-sm-10">
          <input type="tel" class="form-control" id="phone" name="phone" 
                 placeholder="Phone Number" required>
        </div>
      </div>

      <div class="form-group row mb-3">
        <div class="col-sm-10 offset-sm-2">
          <button class="btn btn-dark px-4" type="submit">Submit</button>
        </div>
      </div><br><br><br>
    </form>

  </div>
</section>
<script>
  const existingEmails = {{ emails|safe }};
  const existingPhones = {{ phones|safe }};
  console.log(existingPhones);
  console.log(existingEmails);
  if (existingEmails.length > 0) {
    document.getElementById('inputEmail3').addEventListener('input', function() {
      const email = (this.value).toLowerCase();
      if (existingEmails.includes(email)) {
        this.value = '';
        alert('This email is already registered. Please use a different email.');
      } else {
        this.setCustomValidity('');
      }
    });
  }
  if (existingPhones.length > 0) {
    document.getElementById('phone').addEventListener('input', function() {
      const phone = this.value;
      if (existingPhones.includes(phone)) {
        this.value = '';
        alert('This phone number is already registered. Please use a different phone number.');
      } else {
        this.setCustomValidity('');
      }
    });
  }
</script>
<!-- Sign Up End -->

{% endblock content %}
